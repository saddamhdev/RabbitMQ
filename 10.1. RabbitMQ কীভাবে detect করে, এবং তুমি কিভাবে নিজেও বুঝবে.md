RabbitMQ **BLOCKED CONNECTION** ‡¶ï‡ßá‡¶® ‡¶π‡¶¨‡ßá ‡¶è‡¶¨‡¶Ç ‡¶ï‡¶ø‡¶≠‡¶æ‡¶¨‡ßá **‡¶¨‡ßÅ‡¶ù‡¶¨‡ßá** ‚Äî ‡¶è‡¶á‡¶ü‡¶æ ‡¶¨‡ßã‡¶ù‡¶æ ‡¶Ö‡¶®‡ßá‡¶ï ‡¶ú‡¶∞‡ßÅ‡¶∞‡¶ø, ‡¶ï‡¶æ‡¶∞‡¶£ ‡¶è‡¶ó‡ßÅ‡¶≤‡ßã ‡¶®‡¶æ ‡¶ú‡¶æ‡¶®‡¶≤‡ßá producer ‡¶π‡¶†‡¶æ‡ßé publishing ‡¶¨‡¶®‡ßç‡¶ß ‡¶π‡¶Ø‡¶º‡ßá ‡¶Ø‡ßá‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡•§

‡¶Ü‡¶Æ‡¶ø ‡¶®‡¶ø‡¶ö‡ßá **RabbitMQ ‡¶ï‡ßÄ‡¶≠‡¶æ‡¶¨‡ßá detect ‡¶ï‡¶∞‡ßá**, ‡¶è‡¶¨‡¶Ç **‡¶§‡ßÅ‡¶Æ‡¶ø ‡¶ï‡¶ø‡¶≠‡¶æ‡¶¨‡ßá ‡¶®‡¶ø‡¶ú‡ßá‡¶ì ‡¶¨‡ßÅ‡¶ù‡¶¨‡ßá** ‚Äî ‡¶∏‡¶¨ ‡¶∏‡¶π‡¶ú ‡¶≠‡¶æ‡¶∑‡¶æ‡¶Ø‡¶º ‡¶≤‡¶ø‡¶ñ‡¶õ‡¶ø‡•§

---

# üü• 1) ‚úî **Memory Usage High ‚Äî (Memory Alarm)**

## RabbitMQ ‡¶ï‡ßÄ‡¶≠‡¶æ‡¶¨‡ßá ‡¶¨‡ßã‡¶ù‡ßá?

RabbitMQ ‡¶Ø‡¶ñ‡¶® ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶æ‡¶∞‡ßá‡¶∞ RAM ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ **configured limit (default: 40%)** ‡¶è‡¶∞ ‡¶â‡¶™‡¶∞‡ßá ‡¶Ø‡¶æ‡¶Ø‡¶º, ‡¶§‡¶ñ‡¶®:

‚û° **Memory alarm = ON**
‚û° Publisher Blocked ‡¶ï‡¶∞‡ßá ‡¶¶‡ßá‡ßü
‚û° Consumer continue ‡¶ï‡¶∞‡ßá (pull only)

**Formula:**

```
used_memory >= (total_memory * vm_memory_high_watermark)
```

Default:

```
vm_memory_high_watermark = 0.4  (40%)
```

## ‡¶§‡ßÅ‡¶Æ‡¶ø ‡¶ï‡¶ø‡¶≠‡¶æ‡¶¨‡ßá ‡¶¨‡ßÅ‡¶ù‡¶¨‡ßá?

### ‚úî RabbitMQ Management UI ‚Üí Overview ‚Üí "Memory Alarm"

![Image](https://www.rabbitmq.com/assets/images/mgmt-ui-memory-use-breakdown-ff91d5cba04f72d7188e4130b97f35d2.png?utm_source=chatgpt.com)

![Image](https://www.freekb.net/images/rabbitmq_high_watermark1.png?utm_source=chatgpt.com)

### ‚úî Logs ‡¶è ‡¶è‡¶≠‡¶æ‡¶¨‡ßá ‡¶¶‡ßá‡¶ñ‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá:

```
Memory alarm set. Publishing is blocked.
```

### ‚úî Spring Boot Logs:

```
üî¥ RABBITMQ BLOCKED PUBLISHING: high memory alarm
```

---

# üü• 2) ‚úî **Disk Free Space ‡¶ï‡¶Æ ‚Äî (Disk Alarm)**

## RabbitMQ ‡¶ï‡ßÄ‡¶≠‡¶æ‡¶¨‡ßá detect ‡¶ï‡¶∞‡ßá?

RabbitMQ ‡¶Ø‡¶ñ‡¶® free disk space **limit ‡¶è‡¶∞ ‡¶®‡¶ø‡¶ö‡ßá** ‡¶ö‡¶≤‡ßá ‡¶Ø‡¶æ‡¶Ø‡¶º ‚Üí publishing BLOCK ‡¶π‡ßü‡•§

Default limit: **50 MB**

```
free_disk < disk_free_limit
```

## ‡¶§‡ßÅ‡¶Æ‡¶ø ‡¶ï‡¶ø‡¶≠‡¶æ‡¶¨‡ßá ‡¶¨‡ßÅ‡¶ù‡¶¨‡ßá?

### ‚úî RabbitMQ GUI ‚Üí ‚ÄúDisk Free Alarm‚Äù

### ‚úî Logs:

```
Disk alarm set: free space 45000kB below limit 50000kB
```

### ‚úî Spring Boot:

```
üî¥ BLOCKED: low disk alarm
```

---

# üü• 3) ‚úî **Flow Control Active**

Flow control ‡¶§‡¶ñ‡¶® activate ‡¶π‡ßü ‡¶Ø‡¶ñ‡¶®:

* Queue ‡¶ó‡ßÅ‡¶≤‡ßã ‡¶ñ‡ßÅ‡¶¨ ‡¶¶‡ßç‡¶∞‡ßÅ‡¶§ grow ‡¶ï‡¶∞‡¶õ‡ßá
* Consumers slow
* Message ingress rate too high

RabbitMQ internally ‚Äúcredit-based flow control‚Äù ‡¶ö‡¶æ‡¶≤‡¶æ‡¶Ø‡¶º‡•§

### RabbitMQ ‡¶ï‡ßÄ‡¶≠‡¶æ‡¶¨‡ßá ‡¶¨‡ßÅ‡¶ù‡ßá?

‡¶Ø‡¶ñ‡¶® message incoming rate ‡¶¨‡ßá‡¶∂‡¶ø, ‡¶è‡¶¨‡¶Ç queue / channel buffer full ‡¶π‡ßü ‚Üí RabbitMQ incoming publish slow ‡¶ï‡¶∞‡ßá ‡¶¶‡ßá‡ßü‡•§

### ‡¶§‡ßÅ‡¶Æ‡¶ø ‡¶ï‡ßÄ‡¶≠‡¶æ‡¶¨‡ßá ‡¶¨‡ßÅ‡¶ù‡¶¨‡ßá?

RabbitMQ Logs:

```
Flow control active on connection XYZ
```

RabbitMQ UI ‚Üí Channel section ‡¶è **flow** flag ‡¶¶‡ßá‡¶ñ‡¶æ‡¶¨‡ßá‡•§

---

# üü• 4) ‚úî **Too Many Messages in Queue**

Queue ‚Üí ‡¶Ø‡¶¶‡¶ø millions message accumulate ‡¶π‡ßü:

* Memory ‡¶¨‡¶æ‡¶°‡¶º‡ßá
* Queue paging ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡ßü
* Disk IO degrade ‡¶π‡ßü
* Flow control active ‡¶π‡ßü
* Publisher blocked ‡¶π‡ßü

### RabbitMQ ‡¶ï‡ßÄ‡¶≠‡¶æ‡¶¨‡ßá detect ‡¶ï‡¶∞‡ßá?

Queue-length threshold ‡¶Ö‡¶§‡¶ø‡¶ï‡ßç‡¶∞‡¶Æ ‡¶ï‡¶∞‡¶≤‡ßá paging ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡ßü:

```
Queue grows beyond memory target
Messages moved from RAM ‚Üí Disk
Paging active
```

### ‡¶§‡ßÅ‡¶Æ‡¶ø ‡¶ï‡ßÄ‡¶≠‡¶æ‡¶¨‡ßá ‡¶¨‡ßÅ‡¶ù‡¶¨‡ßá?

RabbitMQ UI ‚Üí Queue ‚Üí Message breakdown:

```
Ready: 1,200,000  
Unacked: 50,000
```

Queue details ‡¶è ‡¶¶‡ßá‡¶ñ‡¶æ‡¶¨‡ßá:

```
Paging: true
```

---

# üü• 5) ‚úî **Back-pressure**

Back-pressure = producer ‚Üí too fast
consumer ‚Üí too slow

‡¶è‡¶ü‡¶æ message system-‡¶è natural behavior‡•§

### RabbitMQ ‡¶ï‡ßÄ‡¶≠‡¶æ‡¶¨‡ßá detect ‡¶ï‡¶∞‡ßá?

* Consumer credit finish
* Channel buffer full
* Network TCP window shrink

‡¶§‡¶ñ‡¶® automatically TCP-level signaling ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßá RabbitMQ producer ‡¶ï‡ßá slow ‡¶ï‡¶∞‡ßá ‡¶¶‡ßá‡ßü (RTT ‡¶¨‡¶æ‡ßú‡ßá, throughput ‡¶ï‡¶Æ‡ßá)‡•§

### ‡¶§‡ßÅ‡¶Æ‡¶ø ‡¶ï‡ßÄ‡¶≠‡¶æ‡¶¨‡ßá ‡¶¨‡ßÅ‡¶ù‡¶¨‡ßá?

Spring Logs:

```
Publisher confirm timeout
TCP slow-start
Connection blocked
```

RabbitMQ logs:

```
Channel flow mode is active
```

---

# üü¢ **Summary Chart ‚Äî ‡¶ï‡¶ñ‡¶® RabbitMQ Publish Block ‡¶ï‡¶∞‡ßá?**

| Condition     | RabbitMQ Reaction | UI Signal          | Logs                  |
| ------------- | ----------------- | ------------------ | --------------------- |
| High Memory   | Block             | Memory alarm       | ‚ÄúMemory alarm set‚Äù    |
| Low Disk      | Block             | Disk alarm         | ‚ÄúDisk alarm set‚Äù      |
| Flow Control  | Slow/Block        | Flow=ACTIVE        | ‚ÄúFlow control active‚Äù |
| Large Queue   | Paging            | Queue paging       | ‚ÄúQueue is paging‚Äù     |
| Back-pressure | Slow              | Channel credit low | ‚ÄúChannel flow active‚Äù |

---

# üü£ BONUS: ‡¶ï‡¶ø‡¶≠‡¶æ‡¶¨‡ßá Block ‡¶π‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶∏‡¶æ‡¶•‡ßá‡¶á catch ‡¶ï‡¶∞‡¶¨‡ßá?

Spring Boot Listener:

```java
@Override
public void onBlocked(Connection connection, String reason) {
   System.out.println("üî¥ BLOCKED: " + reason);
}
```

---

# üü¢ ‡¶ö‡¶æ‡¶á‡¶≤‡ßá ‡¶è‡¶ñ‡¶® ‡¶Ü‡¶Æ‡¶ø ‡¶¶‡¶ø‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶ø:

### ‚úî High-memory protection architecture

### ‚úî Auto-recover + retry + circuit breaker flow

### ‚úî Monitoring setup (Prometheus + Grafana RabbitMQ Dashboard)

### ‚úî Spring Boot dynamic throttling system

‡¶¨‡¶≤‡¶≤‡ßá‡¶á ‡¶è‡¶ï ‡¶ß‡¶æ‡¶™‡ßá ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶ï‡¶∞‡ßá ‡¶¶‡¶ø‡¶ö‡ßç‡¶õ‡¶ø!
